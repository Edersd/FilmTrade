{"version":3,"sources":["../../src/pages/chat-room/chat-room.module.ts","../../src/pages/chat-room/chat-room.ts"],"names":[],"mappings":"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","file":"41.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ChatRoomPage } from './chat-room';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ChatRoomPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ChatRoomPage),\r\n  ],\r\n})\r\nexport class ChatRoomPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat-room/chat-room.module.ts","import { Component, ViewChild } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, Content } from 'ionic-angular';\r\n\r\nimport { AngularFireDatabase, AngularFireList } from '@angular/fire/database';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { Chat, Message, Sesion, Theme } from '../../model/interfaces/interfaces';\r\nimport { AccountProvider } from '../../providers/account/account';\r\n\r\nimport { ConfigProvider } from '../../providers/config/config';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-chat-room',\r\n  templateUrl: 'chat-room.html',\r\n})\r\nexport class ChatRoomPage {\r\n  @ViewChild(Content) content:Content;\r\n  private sesionObject: any = {};\r\n  private chat:Chat;\r\n  private messages:Observable<Message[]>;\r\n  private messagesList:AngularFireList<Message>;\r\n  private newMessage:string;\r\n  private theme:string = '';\r\n  constructor(public navCtrl: NavController,private acoutProv: AccountProvider, public navParams: NavParams, private angularDatabase: AngularFireDatabase, private configProv: ConfigProvider) {\r\n    this.chat = this.navParams.get('chat');\r\n    this.configProv.getTheme().subscribe(themeNumber => {\r\n      console.log(themeNumber);\r\n      switch (themeNumber) {\r\n        case Theme.PHOTOGRAPHER:\r\n          this.theme = 'photographer';\r\n          break;\r\n        case Theme.TALENT:\r\n          this.theme = 'talent';\r\n          break;\r\n        case Theme.HAIR_MAKEUP:\r\n          this.theme = 'makeup';\r\n          break;\r\n        case Theme.VIDEOGRAPHER:\r\n          this.theme = 'videographer';\r\n          break;\r\n      }\r\n    }, error => console.error(error));\r\n    this.configProv.getSesionObject().then(sesion => {\r\n      this.sesionObject = sesion;\r\n      console.log(sesion);\r\n      console.log(this.chat.guest[(this.sesionObject.tipo_usuario === '2')?1:0].name);\r\n    }).catch(error => console.error(error));\r\n    this.messagesList = this.angularDatabase.list(`ionic/chats/${this.chat.key}/messages`);\r\n    this.messages = this.messagesList.snapshotChanges().pipe(\r\n      map(changes => (\r\n        changes.map(c => ({ key: c.payload.key, ...c.payload.val() }))\r\n      ))\r\n    );\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    setTimeout(() => {\r\n      this.content.scrollToBottom(200);\r\n    }, 300);\r\n    this.messagesList.valueChanges().subscribe(data => {\r\n      console.log(data);\r\n      setTimeout(() => {\r\n        this.content.scrollToBottom(200);\r\n      }, 300);\r\n    });\r\n  }\r\n\r\n  private sendMessage():void {\r\n\r\n    this.configProv.getSesionObject().then(sesion => {\r\n      this.sesionObject = sesion;\r\n      this.acoutProv.mensajePush({ to: this.chat.guest[(this.sesionObject.tipo_usuario === '2')?1:0].idGuest }).subscribe(data => {\r\n        console.log('usuario', this.chat.guest[(this.sesionObject.tipo_usuario === '2')?1:0].idGuest);\r\n      }, error => console.error(error));\r\n      \r\n      \r\n    }).catch(error => console.error(error));\r\n\r\n    this.messagesList.push({\r\n      date: Date.now(),\r\n      idGuest: this.sesionObject.id,\r\n      message: this.newMessage\r\n    });\r\n    this.newMessage = '';\r\n    setTimeout(() => {\r\n      this.content.scrollToBottom(200);\r\n    }, 300);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat-room/chat-room.ts"],"sourceRoot":""}